var ve=Object.defineProperty;var le=(b,u,d)=>u in b?ve(b,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):b[u]=d;var fr=(b,u,d)=>(le(b,typeof u!="symbol"?u+"":u,d),d);(function(){"use strict";async function b(m={}){var sr;var _,i=m,z=typeof window=="object",R=typeof WorkerGlobalScope<"u";typeof process=="object"&&((sr=process.versions)!=null&&sr.node)&&process.type!="renderer";var y="./this.program",p=(e,r)=>{throw r},W=self.location.href,H="";function I(e){return i.locateFile?i.locateFile(e,H):H+e}var N,B;if(z||R){try{H=new URL(".",W).href}catch{}R&&(B=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),N=async e=>{var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw new Error(r.status+" : "+r.url)}}var E=console.log.bind(console),A=console.error.bind(console),T,c=!1,l,v,w,g,S,h,V,G=!1;function K(){var e=w.buffer;g=new Int8Array(e),i.HEAPU8=S=new Uint8Array(e),h=new Uint32Array(e),V=new BigInt64Array(e),new BigUint64Array(e)}function cr(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)dr(i.preRun.shift());J(q)}function ur(){G=!0,C.w()}function vr(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)br(i.postRun.shift());J(X)}function $(e){var t;(t=i.onAbort)==null||t.call(i,e),e="Aborted("+e+")",A(e),c=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw v==null||v(r),r}var x;function lr(){return i.locateFile?I("scrabble_solver.wasm"):new URL(""+new URL("scrabble_solver.wasm",self.location.href).href,self.location.href).href}function hr(e){if(e==x&&T)return new Uint8Array(T);if(B)return B(e);throw"both async and sync fetching of the wasm failed"}async function _r(e){if(!T)try{var r=await N(e);return new Uint8Array(r)}catch{}return hr(e)}async function pr(e,r){try{var t=await _r(e),n=await WebAssembly.instantiate(t,r);return n}catch(a){A(`failed to asynchronously prepare wasm: ${a}`),$(a)}}async function wr(e,r,t){if(!e)try{var n=fetch(r,{credentials:"same-origin"}),a=await WebAssembly.instantiateStreaming(n,t);return a}catch(s){A(`wasm streaming compile failed: ${s}`),A("falling back to ArrayBuffer instantiation")}return pr(r,t)}function gr(){return{a:ee}}async function mr(){function e(s,o){return C=s.exports,w=C.v,K(),er=C.y,re(C),C}function r(s){return e(s.instance)}var t=gr();if(i.instantiateWasm)return new Promise((s,o)=>{i.instantiateWasm(t,(f,M)=>{s(e(f))})});x??(x=lr());var n=await wr(T,x,t),a=r(n);return a}class yr{constructor(r){fr(this,"name","ExitStatus");this.message=`Program terminated with exit(${r})`,this.status=r}}var J=e=>{for(;e.length>0;)e.shift()(i)},X=[],br=e=>X.push(e),q=[],dr=e=>q.push(e),Q=!0,U=e=>nr(e),k=()=>ir(),Y=typeof TextDecoder<"u"?new TextDecoder:void 0,Rr=(e,r,t,n)=>{for(var a=r+t;e[r]&&!(r>=a);)++r;return r},Z=(e,r=0,t,n)=>{var a=Rr(e,r,t);if(a-r>16&&e.buffer&&Y)return Y.decode(e.subarray(r,a));for(var s="";r<a;){var o=e[r++];if(!(o&128)){s+=String.fromCharCode(o);continue}var f=e[r++]&63;if((o&224)==192){s+=String.fromCharCode((o&31)<<6|f);continue}var M=e[r++]&63;if((o&240)==224?o=(o&15)<<12|f<<6|M:o=(o&7)<<18|f<<12|M<<6|e[r++]&63,o<65536)s+=String.fromCharCode(o);else{var or=o-65536;s+=String.fromCharCode(55296|or>>10,56320|or&1023)}}return s},D=(e,r,t)=>e?Z(S,e,r):"",Er=(e,r,t,n)=>$(`Assertion failed: ${D(e)}, at: `+[r?D(r):"unknown filename",t,n?D(n):"unknown function"]),j=0;class Ar{constructor(r){this.excPtr=r,this.ptr=r-24}set_type(r){h[this.ptr+4>>2]=r}get_type(){return h[this.ptr+4>>2]}set_destructor(r){h[this.ptr+8>>2]=r}get_destructor(){return h[this.ptr+8>>2]}set_caught(r){r=r?1:0,g[this.ptr+12]=r}get_caught(){return g[this.ptr+12]!=0}set_rethrown(r){r=r?1:0,g[this.ptr+13]=r}get_rethrown(){return g[this.ptr+13]!=0}init(r,t){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(t)}set_adjusted_ptr(r){h[this.ptr+16>>2]=r}get_adjusted_ptr(){return h[this.ptr+16>>2]}}var L=e=>tr(e),Tr=e=>{var r=j;if(!r)return L(0),0;var t=new Ar(r);t.set_adjusted_ptr(r);var n=t.get_type();if(!n)return L(0),r;for(var a of e){if(a===0||a===n)break;var s=t.ptr+16;if(ar(a,n,s))return L(a),r}return L(n),r},Sr=()=>Tr([]),Ur=e=>{throw j||(j=e),j},kr=(e,r)=>{},Pr=()=>$(""),Br=()=>performance.now(),Cr=()=>Date.now(),Mr=e=>e>=0&&e<=3;function Wr(e,r,t){if(!Mr(e))return 28;var n;e===0?n=Cr():n=Br();var a=Math.round(n*1e3*1e3);return V[t>>3]=BigInt(a),0}var Hr=()=>2147483648,Nr=(e,r)=>Math.ceil(e/r)*r,Fr=e=>{var r=w.buffer.byteLength,t=(e-r+65535)/65536|0;try{return w.grow(t),K(),1}catch{}},Ir=e=>{var r=S.length;e>>>=0;var t=Hr();if(e>t)return!1;for(var n=1;n<=4;n*=2){var a=r*(1+.2/n);a=Math.min(a,e+100663296);var s=Math.min(t,Nr(Math.max(e,a),65536)),o=Fr(s);if(o)return!0}return!1},O={},jr=()=>y||"./this.program",F=()=>{if(!F.strings){var e=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:jr()};for(var t in O)O[t]===void 0?delete r[t]:r[t]=O[t];var n=[];for(var t in r)n.push(`${t}=${r[t]}`);F.strings=n}return F.strings},Lr=(e,r,t,n)=>{if(!(n>0))return 0;for(var a=t,s=t+n-1,o=0;o<e.length;++o){var f=e.codePointAt(o);if(f<=127){if(t>=s)break;r[t++]=f}else if(f<=2047){if(t+1>=s)break;r[t++]=192|f>>6,r[t++]=128|f&63}else if(f<=65535){if(t+2>=s)break;r[t++]=224|f>>12,r[t++]=128|f>>6&63,r[t++]=128|f&63}else{if(t+3>=s)break;r[t++]=240|f>>18,r[t++]=128|f>>12&63,r[t++]=128|f>>6&63,r[t++]=128|f&63,o++}}return r[t]=0,t-a},zr=(e,r,t)=>Lr(e,S,r,t),$r=(e,r)=>{var t=0,n=0;for(var a of F()){var s=r+t;h[e+n>>2]=s,t+=zr(a,s,1/0)+1,n+=4}return 0},xr=e=>{for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n<=127?r++:n<=2047?r+=2:n>=55296&&n<=57343?(r+=4,++t):r+=3}return r},Dr=(e,r)=>{var t=F();h[e>>2]=t.length;var n=0;for(var a of t)n+=xr(a)+1;return h[r>>2]=n,0},Or=0,Vr=()=>Q||Or>0,Gr=e=>{var r;Vr()||((r=i.onExit)==null||r.call(i,e),c=!0),p(e,new yr(e))},Kr=(e,r)=>{Gr(e)},Jr=Kr,Xr=e=>52;function qr(e,r,t,n){return 70}var Qr=[null,[],[]],Yr=(e,r)=>{var t=Qr[e];r===0||r===10?((e===1?E:A)(Z(t)),t.length=0):t.push(r)},Zr=(e,r,t,n)=>{for(var a=0,s=0;s<t;s++){var o=h[r>>2],f=h[r+4>>2];r+=8;for(var M=0;M<f;M++)Yr(e,S[o+M]);a+=f}return h[n>>2]=a,0},rr=[],er,P=e=>{var r=rr[e];return r||(rr[e]=r=er.get(e)),r};if(i.noExitRuntime&&(Q=i.noExitRuntime),i.print&&(E=i.print),i.printErr&&(A=i.printErr),i.wasmBinary&&(T=i.wasmBinary),i.arguments&&i.arguments,i.thisProgram&&(y=i.thisProgram),i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.shift()();var tr,nr,ir,ar;function re(e){i._solve_scrabble=e.x,i._free=e.z,i._malloc=e.A,tr=e.B,nr=e.C,ir=e.D,ar=e.E}var ee={a:Er,b:Sr,c:Ur,o:kr,r:Pr,q:Wr,m:Ir,s:$r,t:Dr,i:Jr,p:Xr,n:qr,k:Zr,j:ae,g:fe,u:ce,d:te,e:ne,f:ie,l:oe,h:se};function te(e,r){var t=k();try{P(e)(r)}catch(n){if(U(t),n!==n+0)throw n;_setThrew(1,0)}}function ne(e,r,t){var n=k();try{P(e)(r,t)}catch(a){if(U(n),a!==a+0)throw a;_setThrew(1,0)}}function ie(e,r,t,n){var a=k();try{P(e)(r,t,n)}catch(s){if(U(a),s!==s+0)throw s;_setThrew(1,0)}}function ae(e,r){var t=k();try{return P(e)(r)}catch(n){if(U(t),n!==n+0)throw n;_setThrew(1,0)}}function se(e,r,t,n,a,s){var o=k();try{P(e)(r,t,n,a,s)}catch(f){if(U(o),f!==f+0)throw f;_setThrew(1,0)}}function oe(e,r,t,n,a){var s=k();try{P(e)(r,t,n,a)}catch(o){if(U(s),o!==o+0)throw o;_setThrew(1,0)}}function fe(e,r,t,n){var a=k();try{return P(e)(r,t,n)}catch(s){if(U(a),s!==s+0)throw s;_setThrew(1,0)}}function ce(e,r,t,n,a,s){var o=k();try{return P(e)(r,t,n,a,s)}catch(f){if(U(o),f!==f+0)throw f;_setThrew(1,0)}}function ue(){cr();function e(){var r;i.calledRun=!0,!c&&(ur(),l==null||l(i),(r=i.onRuntimeInitialized)==null||r.call(i),vr())}i.setStatus?(i.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>i.setStatus(""),1),e()},1)):e()}var C;return C=await mr(),ue(),G?_=i:_=new Promise((e,r)=>{l=e,v=r}),_}let u=null;function d(m,_,i,z){const R=m.length,y=m[0].length;if(!(R<=255&&y<=255))throw new Error("Board is too large");const p=[];p.push(R),p.push(y);const W=new Map,H=[],I=function(c){return W.has(c)||(W.set(c,W.size),H.push(c)),W.get(c)};for(let c=0;c<R;++c)for(let l=0;l<y;++l){let v=-1;m[c][l]===null?v=0:m[c][l]===" "?v=1:v=I(m[c][l])+2,p.push(v&255),p.push(v>>8&255)}const N=_.length;p.push(N&255),p.push(N>>8&255);for(let c=0;c<N;++c){const l=_[c],v=l.length;if(!(v<=255))throw new Error("Word is too long");p.push(v);for(let w=0;w<v;++w){const g=I(l[w]);p.push(g&255),p.push(g>>8&255)}}const B=u._malloc(p.length);u.HEAPU8.set(p,B);const E=u._solve_scrabble(B,p.length,z,i?1:0);u._free(B);const A=u.HEAPU8[E]|u.HEAPU8[E+1]<<8|u.HEAPU8[E+2]<<16|u.HEAPU8[E+3]<<24,T=[];for(let c=0;c<A;++c){const l=[];for(let v=0;v<R;++v){const w=[];for(let g=0;g<y;++g){const S=E+4+c*R*y*2+v*y*2+g*2,h=u.HEAPU8[S]|u.HEAPU8[S+1]<<8;h===0?w.push(" "):w.push(H[h-1])}l.push(w)}T.push(l)}self.postMessage(T)}self.onmessage=function(m){const _=m.data;u?d(_.board,_.words,_.allShown,_.numMaxAnswers):b().then(i=>{u=i,d(_.board,_.words,_.allShown,_.numMaxAnswers)})},b().then(m=>{u=m})})();
